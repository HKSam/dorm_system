<style type="text/css">
.item {
	height:25px;
	margin-top:3px;
}
.item span {
	display:inline-block;
	margin-right:10px;
	text-align:right;
	padding-right:0;
	width:100px;
}
.help {
	margin-top:10px;
}
input[type='button'] {
	margin-left:100px;
}
input[type='reset'] {
	margin-left:30px;
}
input[type='text'], input[type='password']{
	width:150px;
	height:20px;
	border:#CCC solid 1px;
	border-radius: 5px;
}
#form1{
	margin-top:50px;
	margin-left:80px;
}
.error{
	font-size:14px;
	color:#F00;
	margin-left:6px;
	}
</style>
<div>
    <div class="right_top btm">
      <div class="rheader"><span class="pageName"><b>管理员信息修改界面</b></span><span class="shuoming">您可以修改您的基本信息</span>
      </div>
   
    </div>
        <div class="right_content">
  	     	 <form id="form1" action="#"  method="post">
          <p class="item"><span>姓名:</span>
             <input type="text" name="adminName" /><span class="error" ></span>
            <br />
          </p>
          <p class="item"><span>原密码:</span>
             <input  type="password" name="old" class="old" />
            <br />
          </p>
          <p class="item"><span>新密码:</span>
             <input  type="password" name="new" class="new" />
            <br />
          </p>
           <p class="item"><span>确认新密码:</span>
             <input  type="password" name="newagain" onblur="check()" class="again" /><span class="error"></span>
           <br />
          </p>
          </p>
          <div class="help">
              <input type="button" value="修改" />
              <input type="reset" value="重置"/>
          </div>
  </form>
  		 </div>
</div>
<script type="text/javascript">
var ok_1=false,ok_2=false;
	function checkName(){
		var value=$('input[type="text"]').val();
		if(value==''){
			 var str="姓名不能为空";
			 $('input[name="adminName"]').next().html(str);
			}else{
				ok_1=true;
				$('input[name="adminName"]').next().html("");
				}
		}
	$.getJSON("name.json",function(data){
		$('input[type="text"]').text(data.name);
		});
	$('input[type="text"]').focusout(function(){
		checkName();
	});
	
	function check(){
		var key1 = $(".new").val();
		var key2 = $(".again").val();
		if(key2 != key1){
		  var str="两次密码不一致";
		   $('.again').next().html(str);
		   $(".again").html(""); 
		}else{
			ok_2=true;
			$('.again').next().html("");
			}
	}
	/*function submitModify(){
		$.post('json/post/post.jsp',$('#form1').serialize(),function(){
			   $.messager.alert("提示","修改成功");
			}
		);	
	}*/
	
	$('input[type="button"]').click(function(){
		//新密码是否输入
		checkName();
		var value=$('.new').val();
		if(!ok_1){
			 $.messager.alert("提示","姓名不能为空");
			}else if(value==''){
				$.post("1.json",$('#form1').serialize(),function(data){
					if(data.status==0){
						 $.messager.alert("提示","修改成功");
						}else{
							$.messager.alert("提示","修改失败");
							}
				});
				}else if(ok_1 && ok_2){
					var password= $(".old").val();
					var newpassword= $(".new").val();
					$.post("2.json",{"password":password},function(data){
						if(data.status==0){
							$.post("",{"password":newpassword},function(data){
								if(data.status==0){
									$.messager.alert("提示","修改成功");
									}else{
										$.messager.alert("提示","修改失败");
										}
								});
							}else{
								$.messager.alert("提示","原密码不正确");
								}
						})
				}
	});
</script>
